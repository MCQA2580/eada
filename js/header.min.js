function dark(){document.body.classList.add("night"),document.cookie="night=1;path=/"}function updateCurrentTime(){const e=new Date(),t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),i=e.getSeconds().toString().padStart(2,"0"),o=`${t}:${n}:${i}`;const a=document.getElementById("current-time");a&&(a.textContent=o)}function setWeatherBackground(e){const t={clear:"https://tse4-mm.cn.bing.net/th/id/OIP-C.ClearSky.jpg",clouds:"https://tse4-mm.cn.bing.net/th/id/OIP-C.CloudySky.jpg",rain:"https://tse4-mm.cn.bing.net/th/id/OIP-C.RainyWeather.jpg",thunderstorm:"https://tse4-mm.cn.bing.net/th/id/OIP-C.Thunderstorm.jpg",snow:"https://tse4-mm.cn.bing.net/th/id/OIP-C.SnowyWeather.jpg",mist:"https://tse4-mm.cn.bing.net/th/id/OIP-C.FoggyWeather.jpg",default:"https://tse4-mm.cn.bing.net/th/id/OIP-C.BCoQC5bMBWeJZyDawPWT1AHaEK?w=324&h=182&c=7&r=0&o=7&pid=1.7&rm=3"},n=e.includes("clear")?"clear":e.includes("cloud")?"clouds":e.includes("rain")?"rain":e.includes("thunder")?"thunderstorm":e.includes("snow")?"snow":e.includes("mist")||e.includes("fog")?"mist":"default",i=t[n]||t.default,a=document.body;a.style.backgroundImage=`linear-gradient(rgba(26, 26, 26, 0.7), rgba(38, 38, 38, 0.6)), url('${i}')`}function getLocalWeather(){const e="YOUR_OPENWEATHERMAP_API_KEY";navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{const n=t.coords.latitude,i=t.coords.longitude,a=`https://api.openweathermap.org/data/2.5/weather?lat=${n}&lon=${i}&appid=${e}&lang=zh_cn`;fetch(a).then(e=>e.json()).then(e=>{e.weather&&e.weather.length>0&&setWeatherBackground(e.weather[0].description.toLowerCase())}).catch(e=>{console.error("获取天气信息失败:",e),setWeatherBackground("default")})},e=>{console.error("获取地理位置失败:",e),setWeatherBackground("default")}):(console.error("浏览器不支持地理位置"),setWeatherBackground("default"))}function light(){dark()}function switchNightMode(){dark()}window.addEventListener("load",function(){$("#loading-box").fadeOut(),dark(),updateCurrentTime(),setInterval(updateCurrentTime,1e3),getLocalWeather()},!1),window.onscroll=function(){document.documentElement.scrollTop+document.body.scrollTop>100?$("#topup").css({display:"block",transform:"translateX(0px)",transition:"0.3s"}):$("#topup").css({transform:"translateX(60px)",transition:"0.3s"})},window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{dark()});